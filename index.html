<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Family Tree</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: rgb(42, 38, 33);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
        }

        #top-icons {
            position: fixed;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 12px;
            align-items: center;
            z-index: 1000;
        }

        .icon-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .icon-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.4);
        }

        .icon-btn svg {
            width: 18px;
            height: 18px;
        }

        .flag-icon {
            width: 28px;
            height: 20px;
            border-radius: 3px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .flag-icon:hover {
            transform: scale(1.1);
            border-color: rgba(255, 255, 255, 0.5);
        }

        #tree-container {
            width: 100vw;
            height: 100vh;
        }

        #tree-svg {
            width: 100%;
            height: 100%;
        }

        .person-node {
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .person-card {
            fill: rgba(40, 44, 52, 0.95);
            stroke: rgba(255, 255, 255, 0.2);
            stroke-width: 1;
            rx: 12;
            ry: 12;
            transition: all 0.3s ease;
        }

        .person-node:hover .person-card {
            fill: rgba(50, 55, 65, 0.98);
            stroke: rgba(100, 150, 255, 0.6);
            stroke-width: 2;
        }

        .person-card.male {
            stroke: rgba(100, 149, 237, 0.5);
        }

        .person-card.female {
            stroke: rgba(255, 105, 180, 0.5);
        }

        .person-node:hover .person-card.male {
            stroke: rgba(100, 149, 237, 0.9);
        }

        .person-node:hover .person-card.female {
            stroke: rgba(255, 105, 180, 0.9);
        }

        .person-name {
            fill: #e0e0e0;
            font-size: 12px;
            font-weight: 500;
            text-anchor: middle;
            pointer-events: none;
        }

        .person-dates {
            fill: rgba(255, 255, 255, 0.5);
            font-size: 9px;
            text-anchor: middle;
            pointer-events: none;
        }

        .link {
            fill: none;
            stroke: rgba(255, 255, 255, 0.15);
            stroke-width: 1.5;
        }

        .link.marriage {
            stroke: rgba(255, 215, 0, 0.3);
            stroke-dasharray: 5, 5;
        }

        .link.parent-child {
            stroke: rgba(100, 200, 255, 0.25);
        }

        /* Expanded card tooltip */
        .tooltip {
            position: fixed;
            background: rgba(30, 34, 42, 0.98);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 16px;
            color: #e0e0e0;
            font-size: 13px;
            max-width: 300px;
            z-index: 1001;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            pointer-events: none;
            opacity: 0;
            transform: translateY(10px);
            transition: opacity 0.3s ease, transform 0.3s ease;
        }

        .tooltip.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .tooltip h3 {
            margin-bottom: 10px;
            color: #fff;
            font-size: 16px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 8px;
        }

        .tooltip-row {
            display: flex;
            margin: 6px 0;
        }

        .tooltip-label {
            color: rgba(255, 255, 255, 0.5);
            width: 80px;
            flex-shrink: 0;
        }

        .tooltip-value {
            color: #e0e0e0;
        }

        .tooltip-value.male {
            color: #6495ed;
        }

        .tooltip-value.female {
            color: #ff69b4;
        }

        #loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #e0e0e0;
            font-size: 1.2rem;
            z-index: 1002;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-top-color: #6495ed;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Info modal */
        #info-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        #info-modal.visible {
            display: flex;
        }

        .modal-content {
            background: rgba(30, 34, 42, 0.98);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 30px;
            max-width: 500px;
            color: #e0e0e0;
            position: relative;
        }

        .modal-content h2 {
            margin-bottom: 20px;
            color: #fff;
            font-weight: 400;
        }

        .modal-content p {
            margin-bottom: 12px;
            line-height: 1.6;
            color: rgba(255, 255, 255, 0.8);
        }

        .modal-content ul {
            margin: 15px 0;
            padding-left: 20px;
        }

        .modal-content li {
            margin: 8px 0;
            color: rgba(255, 255, 255, 0.7);
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.6);
            font-size: 24px;
            cursor: pointer;
            transition: color 0.3s;
        }

        .modal-close:hover {
            color: #fff;
        }

        #file-drop-zone {
            margin-top: 20px;
            padding: 20px;
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        #file-drop-zone:hover {
            border-color: rgba(100, 150, 255, 0.6);
            background: rgba(100, 150, 255, 0.1);
        }

        #file-drop-zone.dragover {
            border-color: rgba(100, 200, 100, 0.8);
            background: rgba(100, 200, 100, 0.1);
        }

        #file-input {
            display: none;
        }

        .privacy-notice {
            margin: 15px 0;
            padding: 12px;
            background: rgba(255, 200, 100, 0.1);
            border-left: 3px solid rgba(255, 200, 100, 0.5);
            border-radius: 4px;
        }

        .privacy-notice p {
            margin: 0;
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.7);
        }

        .corrections-notice {
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.5);
            font-style: italic;
            margin-top: 15px;
        }

        .flag-icon.active {
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.8);
        }
    </style>
</head>
<body>
    <div id="top-icons">
        <!-- British Flag -->
        <svg class="flag-icon active" id="flag-en" viewBox="0 0 60 30" title="English">
            <clipPath id="s"><path d="M0,0 v30 h60 v-30 z"/></clipPath>
            <clipPath id="t"><path d="M30,15 h30 v15 z v15 h-30 z h-30 v-15 z v-15 h30 z"/></clipPath>
            <g clip-path="url(#s)">
                <path d="M0,0 v30 h60 v-30 z" fill="#012169"/>
                <path d="M0,0 L60,30 M60,0 L0,30" stroke="#fff" stroke-width="6"/>
                <path d="M0,0 L60,30 M60,0 L0,30" clip-path="url(#t)" stroke="#C8102E" stroke-width="4"/>
                <path d="M30,0 v30 M0,15 h60" stroke="#fff" stroke-width="10"/>
                <path d="M30,0 v30 M0,15 h60" stroke="#C8102E" stroke-width="6"/>
            </g>
        </svg>

        <!-- Greek Flag -->
        <svg class="flag-icon" id="flag-el" viewBox="0 0 27 18" title="Greek">
            <rect fill="#0D5EAF" width="27" height="18"/>
            <path fill="#FFF" d="M0,2h27v2H0zM0,6h27v2H0zM0,10h27v2H0zM0,14h27v2H0z"/>
            <rect fill="#0D5EAF" width="10" height="10"/>
            <path fill="#FFF" d="M0,4h10v2H0zM4,0h2v10H4z"/>
        </svg>

        <!-- Info Icon -->
        <button class="icon-btn" id="info-btn" title="Information">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="10" stroke="#e0e0e0"/>
                <line x1="12" y1="16" x2="12" y2="12" stroke="#e0e0e0"/>
                <line x1="12" y1="8" x2="12.01" y2="8" stroke="#e0e0e0"/>
            </svg>
        </button>
    </div>

    <div id="loading">
        <div class="spinner"></div>
        <div>Loading family tree...</div>
    </div>

    <div id="tree-container">
        <svg id="tree-svg"></svg>
    </div>

    <div class="tooltip" id="tooltip"></div>

    <!-- Info Modal -->
    <div id="info-modal">
        <div class="modal-content">
            <button class="modal-close" id="modal-close">&times;</button>
            <h2 data-i18n="modal.title">Family Tree Viewer</h2>
            <p data-i18n="modal.description">Interactive family tree visualization.</p>
            <ul>
                <li><strong data-i18n="modal.pan">Pan:</strong> <span data-i18n="modal.panDesc">Click and drag the background</span></li>
                <li><strong data-i18n="modal.zoom">Zoom:</strong> <span data-i18n="modal.zoomDesc">Use mouse wheel to zoom in/out</span></li>
                <li><strong data-i18n="modal.details">Details:</strong> <span data-i18n="modal.detailsDesc">Hover over a person to see more info</span></li>
            </ul>
            <div class="privacy-notice">
                <p data-i18n="modal.privacy">In accordance with UK and EU data protection laws (GDPR), living individuals are not included in this family tree. Only deceased family members are displayed to protect the privacy of living relatives.</p>
            </div>
            <p class="corrections-notice" data-i18n="modal.corrections">If you notice any errors in the family tree, please contact me and I will be happy to make corrections.</p>
            <div id="file-drop-zone">
                <p data-i18n="modal.fileUpload">Click or drop a GEDCOM file here to load your family tree</p>
                <input type="file" id="file-input" accept=".ged,.gedcom">
            </div>
        </div>
    </div>

    <script src="js/gedcom-parser.js"></script>
    <script src="js/family-data.js"></script>
    <script src="js/translations.js"></script>
    <script src="js/family-tree.js"></script>
</body>
</html>
